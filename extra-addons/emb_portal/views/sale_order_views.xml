<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <!-- Custom product.form 此处安装时，有BUG， 需要修改product_normal_form_view 为product_template_form_view， 然后再改回来s -->
        <record id="product_normal_form_view" model="ir.ui.view">
            <field name="name">product.product.form</field>
            <field name="model">product.product</field>
            <field name="inherit_id" ref="product.product_normal_form_view"/>
            <field eval="8" name="priority"/>
            <field name="arch" type="xml">
                <field name="type" position="after">
                    <field name="product_type"/>
                    <field name="design_name"/>
                    <field name="stitch_count"/>
                    <field name="line_data"/>
                </field>
                <xpath expr="//page[@name='notes']/group[@name='description_internal']" position="replace">
                    <div class="banners">
                        <field name="design_image_ids" mode="kanban">
                     <kanban>
                         <field name="image"/>
                         <templates>
                           <t t-name="kanban-box">
                               <div style="position: relative;width:100%;">
                              <div class="oe_module_vignette">
                                  <a type="open">
                                      <img t-att-src="'data:image/png;base64, ' + record.image.raw_value" class="oe_avatar oe_kanban_avatar_smallbox"/>
                                  </a>
                              </div>
                               </div>
                           </t>
                         </templates>
                     </kanban>
                   </field>
                    </div>
                </xpath>
            </field>
        </record>
        <!-- end -->
        <record id="product_template_form_view" model="ir.ui.view">
            <field name="name">product.template.common.form</field>
            <field name="model">product.template</field>
            <field name="inherit_id" ref="product.product_template_form_view"/>
            <field name="arch" type="xml">
                <xpath expr="//page[@name='general_information']/group/group[@name='group_general']" position="replace">
                    <group name="group_general_new">
                        <field name="type" invisible="1"/>
                        <field name="categ_id" string="Category" invisible="1"/>
                    </group>
                </xpath>
                <xpath expr="//page[@name='notes']/group[@name='description']" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>
                <xpath expr="/form/sheet/notebook/page[@name='sales']" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>
                <xpath expr="/form/sheet/notebook/page[@name='purchase']" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>
                <xpath expr="/form/sheet/notebook/page[@name='invoicing']" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>
            </field>
        </record>
        
        <!-- Add "Asset Category" to supplier invoices -->
        <record model="ir.ui.view" id="view_order_form_new">
            <field name="name">sale.order.form</field>
            <field name="model">sale.order</field>
            <field name="inherit_id" ref="sale.view_order_form"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='partner_shipping_id']" position="after">
                    <field string="Shipping Date" name="ship_date" />
                    <field string="Require Date" name="require_date" />
                </xpath>
                <xpath expr="//field[@name='payment_term_id']" position="after">
                    <field string="P.O.#" name="po_number" />
                    <field string="Job Name" name="job_title" />
                    <field string="Shipper" name="shipper_name" />
                    <field string="Instruction" name="instruction" />
                </xpath>
                <xpath expr="//field[@name='order_line']/tree/field[@name='product_id']" position="replace">
                    <field name="logo_name" string="Design Name" />
                    <field name="logo_service" string="Service" />
                    <field name="service_type" string="Type" />
                    <field name="logo_stitch" string="Ks" />
                </xpath>
                <xpath expr="/form/sheet/notebook/page[2]" position="before">
                    <page string="Garment Information">
                        <field name="order_garment" mode="tree">
                            <tree string="Garments" editable="bottom">
                                <field name="sequence" widget="handle"/>
                                <field name="name" string="Product#"/>
                                <field name="style" string="Style"/>
                                <field name="color" string="Color"/>
                                <field name="brand" string="Brand"/>
                                <field name="qty_formatted" string="Qty"/>
                                <field name="qty" string="Total Qty"/>
                            </tree>
                        </field>
                        <div class="oe_clear"/>
                    </page>
                </xpath>
            </field>
        </record>
        <!-- Modify "bom" bom line tree views -->
        <record model="ir.ui.view" id="mrp_bom_form_view_with_garment">
            <field name="name">mrp.bom.form</field>
            <field name="model">mrp.bom</field>
            <field name="inherit_id" ref="mrp.mrp_bom_form_view"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='bom_line_ids']/tree" position="replace">
                    <tree string="Components" editable="bottom">
                        <field name="sequence" widget="handle"/>
                        <field name="product_id" context="{'default_type': 'product'}"/>
                        <field name="garment_type" />
                        <field name="garment_style" />
                        <field name="garment_brand" />
                        <field name="garment_color" />
                        <field name="garment_quantity" />
                        <field name="garment_location" />
                    </tree>
                </xpath>
            </field>
        </record>
        <record model="ir.ui.view" id="emb_purchase_order_tree">
            <field name="name">purchase.order.tree</field>
            <field name="model">purchase.order</field>
            <field name="inherit_id" ref="purchase.purchase_order_tree" />
            <field name="arch" type="xml">
                <xpath expr="//field[@name='amount_untaxed']" position="replace">
                    <field name="amount_untaxed" invisible="1" sum="Total Untaxed amount" string="Untaxed" widget="monetary"/>
                    <field name="stitch" />
                </xpath>
                <xpath expr="//field[@name='amount_total']" position="replace">
                    <field name="amount_total" invisible="1" sum="Total amount" widget="monetary"/>
                </xpath>
                <xpath expr="//field[@name='state']" position="replace">
                    <field name="state" invisible="1"/>
                </xpath>
                <xpath expr="//field[@name='invoice_status']" position="replace">
                    <field name="invoice_status" invisible="1"/>
                </xpath>
            </field>
        </record>
        <record model="ir.ui.view" id="emb_purchase_order_form">
			<field name="name">purchase.order.form</field>
			<field name="model">purchase.order</field>
			<field name="inherit_id" ref="purchase.purchase_order_form" />
			<field name="arch" type="xml">
                <xpath expr="//field[@name='order_line']/form/sheet/notebook/page[1]/field[@name='name']" position="replace">
                    <field name='p_design_image' widget="image" class="bpg_image oe_avatar" />
                </xpath>
				<xpath expr="//field[@name='order_line']/tree" position="replace">
					<tree string="Purchase Order Lines" editable="bottom">
						<field name="currency_id" invisible="1" />
						<field name="state" invisible="1" />
						<field name="sequence" widget="handle" />
						<field name="product_id" attrs="{'readonly': [('state', 'in', ('purchase', 'to approve','done', 'cancel'))]}" context="{'partner_id':parent.partner_id, 'quantity':product_qty,'uom':product_uom, 'company_id': parent.company_id}" force_save="1" />
						<field name="name" />
                        <field name="p_customer" />
                        <field name="p_design_size" />
                        <field name="p_design_size_unit" />
                        <field name="p_specital_instr" />
                        <field name="p_fabric" />
                        <field name="design_image"  widget="binary" />
                        <field name="p_stitch" />
						<field name="move_dest_ids" invisible="1" />
						<field name="company_id" groups="base.group_multi_company" options="{'no_create': True}" />
						<field name="account_analytic_id" context="{'default_partner_id':parent.partner_id}" groups="purchase.group_analytic_accounting" />
						<field name="analytic_tag_ids" groups="purchase.group_analytic_accounting" widget="many2many_tags" options="{'color_field': 'color'}" />
						<field name="product_qty" invisible="1"/>
						<field name="qty_received" invisible="1" />
						<field name="qty_invoiced" invisible="1" />
			        	<field name="product_uom" invisible="1" groups="product.group_uom" attrs="{'readonly': [('state', 'in', ('purchase', 'done', 'cancel'))]}" force_save="1" />
						<field name="price_unit" invisible="1" />
						<field name="taxes_id" invisible="1" widget="many2many_tags" domain="[('type_tax_use','=','purchase')]" context="{'default_type_tax_use': 'purchase'}" options="{'no_create': True}" />
						<field name="price_subtotal" invisible="1" widget="monetary" />
					</tree>
				</xpath>
			</field>
		</record>
        <record model="ir.ui.view" id="emb_work_order_form">
			<field name="name">mrp.production.work.order.form</field>
            <field name="model">mrp.workorder</field>
			<field name="inherit_id" ref="mrp.mrp_production_workcenter_form_view_inherit" />
			<field name="arch" type="xml">
                <xpath expr="//field[@name='product_id']" position="after">
                    <field name="logo_file" filename="logo_file_name" />
                    <field name="logo_file_name" invisible="1"/>
                </xpath>
            </field>
        </record>    
    </data>
</odoo>
